<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Null Hypothesis Significance Testing Via Permutation Tests – 2025 UseR Lightening Talk</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-075b30d53143ce7f9002a703b6dcc756.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">2025 UseR Lightening Talk</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"><img src="images/igloo.png" alt="Home" style="height:30px;"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Null Hypothesis Significance Testing Via Permutation Tests</h1>
<p class="subtitle lead">A WebR Tutorial</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blorg.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%" alt="A playful image of a player and an ice monster named Blorg getting ready to play a game of sliding ice boulders"></p>
</figure>
</div>
<section id="the-scenario" class="level1">
<h1>The scenario</h1>
<p>In this activity, we will work with data from <a href="https://osf.io/rcfy5/">a study</a> conducted by Drs. Jake Hofman, Daniel Goldstein &amp; Jessica Hullman.</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/viz_effects_title.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>In the experiment, participants were told they were <strong>athletes competing in a boulder sliding game</strong> against an equally skilled opponent named Blorg. The objective was to <strong>slide a boulder farther on ice than their opponent to win a 250 Ice Dollar prize</strong>, awarded to the contestant with the longest slide. They had the option to <strong>rent a “special boulder”</strong> — a potentially advantageous (but not guaranteed) upgrade expected to improve their sliding distance in their final competition. Participants then <strong>saw a visualization with statistics comparing the standard and special boulders</strong>. After studying the randomly selected visualization, the participants <strong>indicated how much they would be willing to pay for the special boulder</strong> and estimated their probability of winning with it.</p>
<p>Participants were <strong>randomly assigned to see one of the following visualizations</strong> that they could use to decide how much to pay for the special boulder and how certain they were that it would help them win. These four visualization types are shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/hulman_viz_types.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>The conditions, moving from left to right, are described as:</p>
<ol type="1">
<li>A 95% Confidence Interval (CI)</li>
<li>A 95% Prediction Interval (PI)</li>
<li>A rescaled 95% CI (CI_rescaled, i.e., the y-axis is rescaled to have the same range as the PI graph)</li>
<li>Hypothetical Outcomes Plots (HOPS), which show uncertainty through a series of animated frames that depict samples from underlying distributions.</li>
</ol>
<p>Additionally, participants were randomly assigned to see either a <strong>small effect</strong> (probability of winning with the special boulder = 0.57, where 0.5 indicates even odds) or a <strong>large effect</strong> (probability of winning with the special boulder = 0.76). In this activity, we’ll focus on the participants who were randomly assigned to see visualizations depicting a large effect size.</p>
<p>We’ll consider two variables in this activity:</p>
<ul>
<li><p><strong>graph_type</strong> provides the type of graph the participant viewed — this is the randomly assigned condition. The types are called <strong>CI</strong>, <strong>PI</strong>, <strong>CI rescaled</strong>, and <strong>HOPS</strong> (corresponding to the descriptions above).</p></li>
<li><p>The outcome that we will consider here is called <strong>wtp_final</strong>. It represents the amount of money (in Ice Dollars) that the participant reported they would pay to rent the special boulder.</p></li>
</ul>
</section>
<section id="graph-the-results" class="level1">
<h1>Graph the results</h1>
<p>The graph below shows the average willingness to pay for the special boulder in each visualization condition, with 95% confidence intervals to reflect variability.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="UseR2025_webRactivity_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this graph:</p>
<ul>
<li><p><strong>Each point</strong> shows the <strong>sample mean</strong> willingness to pay for the special boulder in each visualization condition.</p></li>
<li><p><strong>Error bars</strong> represent <strong>95% confidence intervals</strong> for the group means. They provide a sense of the <strong>precision of our estimates</strong> — narrower bars indicate more precise estimates.</p></li>
</ul>
</section>
<section id="goal-of-this-activity" class="level1">
<h1>Goal of this activity</h1>
<p>In this activity, we will investigate whether the <strong>average willingness to pay for the special boulder</strong> differs between two visualization conditions (e.g., CI vs.&nbsp;PI).</p>
<p>You will:</p>
<ol type="1">
<li><p><strong>Select two conditions</strong> and calculate the observed difference in mean willingness to pay.</p></li>
<li><p><strong>Evaluate how unusual that difference is under the null hypothesis</strong> that there is no true effect.</p></li>
</ol>
<p>By the end of this activity, you’ll <strong>interpret the resulting <em>p</em>‑value</strong> and gain intuition for deciding whether an observed difference likely reflects <strong>real group differences</strong> or is simply <strong>due to chance</strong>.</p>
</section>
<section id="what-is-a-permutation-test" class="level1">
<h1>What is a permutation test?</h1>
<p>When we run a statistical test, we want to know if an observed difference—like how much more students are willing to pay for the <strong>special boulder</strong> in one condition versus another — is just <strong>random chance</strong> or reflects a <strong>real effect</strong>.</p>
<p>A <strong>permutation test</strong> answers this by showing what the data would look like <strong>if there were no real difference</strong> between the conditions. We do this by repeatedly <strong>shuffling the group labels</strong> in the dataset. Each time we shuffle:</p>
<ol type="1">
<li><p>We <strong>reassign</strong> each participant’s willingness to pay to a random condition.</p></li>
<li><p>We <strong>recalculate the mean difference</strong> between conditions.</p></li>
</ol>
<p>Repeating this many times gives us a <strong>null distribution</strong>: the differences we’d expect <strong>purely by chance</strong> if the null hypothesis were true. Finally, we <strong>compare our observed difference</strong> to this null distribution. If it falls far into the tails—much larger or smaller than what we’d expect by chance—it suggests the difference is <strong>unlikely to be random</strong> and may reflect a <strong>genuine effect</strong>.</p>
<p>To see an example, let’s perform <strong>one shuffle</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># shuffle data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>shuffled_groups <span class="ot">&lt;-</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shuffled_group =</span> <span class="fu">sample</span>(graph_type))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>shuffled_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 910 × 3
   graph_type wtp_final shuffled_group
   &lt;fct&gt;          &lt;dbl&gt; &lt;fct&gt;         
 1 HOPS              50 HOPS          
 2 HOPS              25 CI            
 3 PI                50 CI            
 4 CI                50 HOPS          
 5 CI                50 CI            
 6 HOPS              50 PI            
 7 HOPS             150 PI            
 8 CI                11 HOPS          
 9 CI                50 CI rescaled   
10 HOPS              20 PI            
# ℹ 900 more rows</code></pre>
</div>
</div>
<p>Notice that the data frame now has the “real condition” (<span class="variable-name">graph_type</span>) and a randomly shuffled condition (<span class="variable-name">shuffled_group</span>).</p>
<p>We need <strong>many shuffled datasets</strong> to accurately assess how unusual our observed difference is.</p>
<p>In a permutation test, we don’t rely on a single shuffle. Instead, we <strong>repeatedly shuffle the group labels</strong> — thousands of times. For each shuffle, we:</p>
<ol type="1">
<li><p>Randomly reassign participants to groups.</p></li>
<li><p>Calculate the mean willingness to pay for each shuffled group.</p></li>
<li><p>Record the difference between the shuffled group means.</p></li>
</ol>
<p>Repeating this process produces a <strong>null distribution of mean differences</strong> — what we’d expect to see <strong>purely by chance</strong> if the null hypothesis were true. Comparing our <strong>observed difference</strong> to this null distribution shows whether it’s likely due to <strong>random variation</strong> or reflects a <strong>real effect</strong>.</p>
<p>The graph below recreates the earlier plot using 5,000 shuffled datasets. It displays the observed group means along with their variability under repeated random shuffles. While the error bars in the previous graph summarize the uncertainty <strong>around our observed</strong> group means (i.e.&nbsp;the familiar 95% confidence intervals), this plot shows what those group means would look like <strong>if there really were no effect</strong>. Here, each point is the average willingness‐to‐pay from one of 5,000 random reassignments of labels, and the shaded bands mark the <strong>central 95% region</strong> of that <em>null</em> distribution. In other words, these “permutation intervals” visualize the range of mean differences we’d expect <strong>purely by chance</strong> under the null hypothesis.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="UseR2025_webRactivity_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As expected, the shuffled groups show almost no difference in willingness to pay, reflecting that random reassignment does not create a real effect.</p>
</section>
<section id="conduct-a-null-hypothesis-significance-test-using-a-permutation-test" class="level1">
<h1>Conduct a null hypothesis significance test using a permutation test</h1>
<p>Let’s use the permutation test approach to determine if there is a significant difference in willingness to pay for the special boulder between two selected groups.</p>
</section>
<section id="import-the-data" class="level1">
<h1>Import the data</h1>
<p>Please click <strong>Run Code</strong> on the code chunk below to import the data.</p>
<div>
<div id="webr-1" class="exercise-cell">

</div>
<script type="webr-1-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWUsIm1lc3NhZ2UiOmZhbHNlfSwiY29kZSI6IlxuZGYgPC0gcmVhZF9jc3YoXCJkYXRhL3VuY2VydGFpbnR5X2V4cDIuY3N2XCIpIHw+XG4gIGZpbHRlcihlZmZlY3Rfc2l6ZSA9PSBcIkxhcmdlIGVmZmVjdCBzaXplXCIpIHw+XG4gIHNlbGVjdChncmFwaF90eXBlLCB3dHBfZmluYWwpIHw+XG4gIGRyb3BfbmEoKSB8PlxuICBtdXRhdGUoZ3JhcGhfdHlwZSA9IGZhY3RvcihcbiAgICBncmFwaF90eXBlLFxuICAgIGxldmVscyA9IGMoXCJDSVwiLCBcIlBJXCIsIFwiQ0kgcmVzY2FsZWRcIiwgXCJIT1BTXCIpXG4gICkpXG5cbmRmIHw+IGhlYWQobiA9IDEwKSJ9
</script>
</div>
<section id="step-1-choose-two-conditions-to-compare" class="level2">
<h2 class="anchored" data-anchor-id="step-1-choose-two-conditions-to-compare">Step 1: Choose two conditions to compare</h2>
<p>First, <strong>choose two conditions</strong> to compare. The code below will assign one condition to be called Group A, and the other condition to be called Group B. By default HOPS and PI are compared, but you can change these to compare other groups.</p>
<ul>
<li>CI</li>
<li>CI rescaled</li>
<li>PI</li>
<li>HOPS</li>
</ul>
<p>The code also creates a dummy-coded variable to compare Group B to Group A (which we’ll use later in the activity).</p>
<p>Press <strong>Run Code</strong> to create the subsetted data frame for the investigation.</p>
<div>
<div id="webr-2" class="exercise-cell">

</div>
<script type="webr-2-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIGlucHV0IHRoZSBuYW1lcyBvZiB0aGUgZ3JvdXBzIHlvdSdkIGxpa2UgdG8gY29tcGFyZVxuc2VsZWN0aW9uXzEgPC0gXCJQSVwiXG5zZWxlY3Rpb25fMiA8LSBcIkhPUFNcIlxuXG5teV9ncm91cHMgPC1cbiAgZGYgfD4gXG4gIGZpbHRlcihncmFwaF90eXBlICVpbiUgYyhzZWxlY3Rpb25fMSwgc2VsZWN0aW9uXzIpKSB8PiBcbiAgbXV0YXRlKFxuICAgIGdyb3VwID0gY2FzZV93aGVuKFxuICAgICAgZ3JhcGhfdHlwZSA9PSBzZWxlY3Rpb25fMSB+IFwiQVwiLFxuICAgICAgZ3JhcGhfdHlwZSA9PSBzZWxlY3Rpb25fMiB+IFwiQlwiXG4gICAgKSxcbiAgICBncm91cCA9IGZhY3Rvcihncm91cCwgbGV2ZWxzID0gYyhcIkFcIiwgXCJCXCIpKSxcbiAgICBncm91cEIgPSBjYXNlX3doZW4oXG4gICAgICBncm91cCA9PSBcIkJcIiB+IDEsXG4gICAgICBUUlVFIH4gMFxuICAgIClcbiAgKSB8PiBcbiAgc2VsZWN0KHd0cF9maW5hbCwgZ3JvdXAsIGdyb3VwQilcblxubXlfZ3JvdXBzIn0=
</script>
</div>
</section>
<section id="step-2-compute-descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="step-2-compute-descriptive-statistics">Step 2: Compute descriptive statistics</h2>
<blockquote class="blockquote">
<p>What is the average willingness to pay for the special boulder in each of your selected conditions?</p>
</blockquote>
<p>Press <strong>Run Code</strong> on the code chunk below to compute the mean and standard deviation of willingness to pay for the special boulder in your selected conditions. The code also calculates the sample size of each group.</p>
<div>
<div id="webr-3" class="exercise-cell">

</div>
<script type="webr-3-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5teV9ncm91cHMgfD4gXG4gIGdyb3VwX2J5KGdyb3VwKSB8PiBcbiAgc3VtbWFyaXplKG1lYW4gPSBtZWFuKHd0cF9maW5hbCksXG4gICAgICAgICAgICBzZCA9IHNkKHd0cF9maW5hbCksXG4gICAgICAgICAgICBuID0gbigpKSJ9
</script>
</div>
<blockquote class="blockquote">
<p>What is the mean difference in willingness to pay between the two groups?</p>
</blockquote>
<p>Press <strong>Run Code</strong> to calculate the difference in willingness to pay between these two groups.</p>
<div>
<div id="webr-4" class="exercise-cell">

</div>
<script type="webr-4-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIGNhbGN1bGF0ZSB0aGUgb2JzZXJ2ZWQgZGlmZmVyZW5jZSAoR3JvdXAgQiAtIEdyb3VwIEEpXG5vYnNlcnZlZF9kaWZmIDwtIFxuICBteV9ncm91cHMgfD5cbiAgZ3JvdXBfYnkoZ3JvdXApIHw+XG4gIHN1bW1hcmlzZShtZWFuX3ZhbHVlID0gbWVhbih3dHBfZmluYWwpKSB8PlxuICBwaXZvdF93aWRlcihuYW1lc19mcm9tID0gZ3JvdXAsIHZhbHVlc19mcm9tID0gbWVhbl92YWx1ZSkgfD5cbiAgbXV0YXRlKG9ic2VydmVkX2RpZmYgPSBCIC0gQSkgfD4gXG4gIHB1bGwob2JzZXJ2ZWRfZGlmZilcblxuIyBmb3JtYXQgZm9yIHJlcG9ydGluZ1xuY2F0KFwiRGlmZmVyZW5jZSBiZXR3ZWVuIGdyb3VwcyAoQiAtIEEpOlwiLCBcbiAgICBzcHJpbnRmKFwiJS4yZlwiLCBvYnNlcnZlZF9kaWZmKSwgXG4gICAgXCJcXG5cIikifQ==
</script>
</div>
<blockquote class="blockquote">
<p>Last, let’s create a plot of the raw data. Press <strong>Run Code</strong> to visualize the distribution of willingness to pay for these two groups.</p>
</blockquote>
<div>
<div id="webr-5" class="exercise-cell">

</div>
<script type="webr-5-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIGNhbGN1bGF0ZSBtZWFuIGFuZCA5NSUgQ0kgZm9yIGVhY2ggY29uZGl0aW9uXG5kZl9zdW1tYXJ5IDwtIFxuICBteV9ncm91cHMgfD4gXG4gIGdyb3VwX2J5KGdyb3VwKSB8PlxuICBzdW1tYXJpemUoXG4gICAgbWVhbl93dHAgPSBtZWFuKHd0cF9maW5hbCksXG4gICAgY2lfbG93ID0gbWVhbl93dHAgLSBxdCgwLjk3NSwgZGYgPSBuKCkgLSAxKSAqIHNkKHd0cF9maW5hbCkgLyBzcXJ0KG4oKSksXG4gICAgY2lfaGlnaCA9IG1lYW5fd3RwICsgcXQoMC45NzUsIGRmID0gbigpIC0gMSkgKiBzZCh3dHBfZmluYWwpIC8gc3FydChuKCkpXG4gIClcblxuIyBjYWxjdWxhdGUgdGhlIGRpZmZlcmVuY2UgZm9yIGFubm90YXRpb25cbm9ic2VydmVkX2RpZmYgPC0gZGlmZihkZl9zdW1tYXJ5JG1lYW5fd3RwKVxuXG4jIGNhbGN1bGF0ZSBtaWRwb2ludCBmb3IgbGFiZWwgcGxhY2VtZW50XG5taWRwb2ludF95IDwtIG1lYW4oZGZfc3VtbWFyeSRtZWFuX3d0cClcblxuIyBjcmVhdGUgcGxvdFxuZGZfc3VtbWFyeSB8PiBcbiAgbXV0YXRlKFxuICAgIGdyb3VwX2NvbG9yID0gY2FzZV93aGVuKFxuICAgICAgZ3JvdXAgPT0gXCJCXCIgfiBcIiNmNmEyN2JcIiwgIFxuICAgICAgZ3JvdXAgPT0gXCJBXCIgfiBcIiM3YmNmZjZcIiAgICAgXG4gICAgKVxuICApIHw+IFxuICBnZ3Bsb3QobWFwcGluZyA9IGFlcyh4ID0gZ3JvdXAsIHkgPSBtZWFuX3d0cCwgY29sb3IgPSBncm91cF9jb2xvcikpICtcbiAgIyBDb25maWRlbmNlIGludGVydmFsc1xuICBnZW9tX2xpbmVyYW5nZShcbiAgICBtYXBwaW5nID0gYWVzKHltaW4gPSBjaV9sb3csIHltYXggPSBjaV9oaWdoKSxcbiAgICBsaW5ld2lkdGggPSAyLFxuICAgIGFscGhhID0gMC4zXG4gICkgK1xuICAjIHBvaW50c1xuICBnZW9tX3BvaW50KHNpemUgPSA0LCBzaGFwZSA9IDE2KSArXG4gICMgZGlmZmVyZW5jZSBhbm5vdGF0aW9uXG4gIGdlb21fc2VnbWVudChcbiAgICB4ID0gMSwgeGVuZCA9IDIsXG4gICAgeSA9IGRmX3N1bW1hcnkkbWVhbl93dHBbMV0sIHllbmQgPSBkZl9zdW1tYXJ5JG1lYW5fd3RwWzJdLFxuICAgIGNvbG9yID0gXCJsaWdodGdyZXlcIiwgbGluZXdpZHRoID0gMC41LCBsaW5ldHlwZSA9IFwiZG90dGVkXCJcbiAgKSArXG4gIGdlb21fbGFiZWwoXG4gICAgeCA9IDEuNSwgeSA9IG1pZHBvaW50X3ksXG4gICAgbGFiZWwgPSBzcHJpbnRmKFwiRGlmZmVyZW5jZTogJS4yZlwiLCBvYnNlcnZlZF9kaWZmKSxcbiAgICBjb2xvciA9IFwiYmxhY2tcIiwgZmlsbCA9IFwibGlnaHRncmV5XCIsIHNpemUgPSA1XG4gICkgK1xuICBzY2FsZV9jb2xvcl9pZGVudGl0eSgpICsgIFxuICBsYWJzKFxuICAgIHRpdGxlID0gXCJIb3cgVmlzdWFsaXphdGlvbiBUeXBlIEFmZmVjdHMgV2lsbGluZ25lc3MgdG8gUGF5XCIsXG4gICAgc3VidGl0bGUgPSBcIk1lYW4gYW5kIDk1JSBDSSBhcmUgZGlzcGxheWVkXCIsXG4gICAgeCA9IFwiR3JhcGggdHlwZSB2aWV3ZWQgLyBDb25kaXRpb25cIiwgXG4gICAgeSA9IFwiV2lsbGluZ25lc3MgdG8gcGF5XCJcbiAgKSArXG4gIHRoZW1lX2J3KCkgIn0=
</script>
</div>
</section>
<section id="step-3-state-the-null-and-alternative-hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="step-3-state-the-null-and-alternative-hypothesis">Step 3: State the null and alternative hypothesis</h2>
<ul>
<li><p><strong>Null hypothesis</strong>: <span class="math inline">\(H_0: \mu_{\text{GroupA}} = \mu_{\text{GroupB}}\)</span> (the two means are equal). Or equivalently: <span class="math inline">\(H_0: \mu_{\text{GroupA}} - \mu_{\text{GroupB}} = 0\)</span> (the difference in means is zero)</p></li>
<li><p><strong>Alternative hypothesis</strong>: <span class="math inline">\(H_a: \mu_{\text{GroupA}} \neq \mu_{\text{GroupB}}\)</span> (the two means are not equal). Or equivalently: <span class="math inline">\(H_a: \mu_{\text{GroupA}} - \mu_{\text{GroupB}} \neq 0\)</span> (the difference in means is not zero)</p></li>
</ul>
</section>
<section id="step-4-mimic-the-sampling-distribution-for-the-difference-in-group-means-under-the-null-hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="step-4-mimic-the-sampling-distribution-for-the-difference-in-group-means-under-the-null-hypothesis">Step 4: Mimic the sampling distribution for the difference in group means under the null hypothesis</h2>
<p>Using permutations, we can approximate the sampling distribution of the difference in willingness to pay between the two groups under the null hypothesis. Press  <strong>Run Code</strong>  to perform 5,000 permutations, calculating the mean willingness to pay for each shuffled group in every iteration.</p>
<div>
<div id="webr-6" class="exercise-cell">

</div>
<script type="webr-6-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIGRlZmluZSBudW1iZXIgb2YgcGVybXV0YXRpb25zXG5uX3Blcm11dGF0aW9ucyA8LSA1MDAwXG5cbiMgY3JlYXRlIHBlcm11dGF0aW9uc1xucGVybXV0YXRpb25fbGlzdCA8LSByZXBsaWNhdGUobl9wZXJtdXRhdGlvbnMsIHtcbiAgbXlfZ3JvdXBzIHw+XG4gICAgbXV0YXRlKFxuICAgICAgb3JpZ2luYWxfZ3JvdXAgPSBncm91cCxcbiAgICAgIHNodWZmbGVkX2dyb3VwID0gc2FtcGxlKGdyb3VwKVxuICAgICkgfD5cbiAgICBzZWxlY3Qod3RwX2ZpbmFsLCBvcmlnaW5hbF9ncm91cCwgc2h1ZmZsZWRfZ3JvdXApXG59LCBzaW1wbGlmeSA9IEZBTFNFKSJ9
</script>
</div>
<p>The graphic below shows how permutation works. The first panel displays the original data with the true group assignments, and the next three panels illustrate the first three shuffles of those assignments. Notice that after shuffling, the group labels no longer carry real meaning — any patterns that emerge are purely due to chance.</p>
<div>
<div id="webr-7" class="exercise-cell">

</div>
<script type="webr-7-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWUsImZpZy5oZWlnaHQiOjgsImZpZy53aWR0aCI6MTJ9LCJjb2RlIjoiXG4jIGFkZCBvYnNlcnZlZCBkYXRhIGFzIHBlcm11dGF0aW9uIDBcbm9ic2VydmVkX2RmIDwtIG15X2dyb3VwcyB8PlxuICBtdXRhdGUoXG4gICAgb3JpZ2luYWxfZ3JvdXAgPSBncm91cCxcbiAgICBzaHVmZmxlZF9ncm91cCA9IGdyb3VwLFxuICAgIHBlcm11dGF0aW9uID0gMFxuICApIHw+XG4gIHNlbGVjdChwZXJtdXRhdGlvbiwgd3RwX2ZpbmFsLCBvcmlnaW5hbF9ncm91cCwgc2h1ZmZsZWRfZ3JvdXApXG5cbiMgY29tYmluZSBvYnNlcnZlZCArIHBlcm11dGVkXG5vdXRwdXQgPC0gYmluZF9yb3dzKFxuICBvYnNlcnZlZF9kZixcbiAgYmluZF9yb3dzKHBlcm11dGF0aW9uX2xpc3QsIC5pZCA9IFwicGVybXV0YXRpb25cIikgfD5cbiAgICBtdXRhdGUocGVybXV0YXRpb24gPSBhcy5pbnRlZ2VyKHBlcm11dGF0aW9uKSlcbilcblxuIyBzZWxlY3QgYSBzdWJzZXQgKG9ic2VydmVkICsgMyBwZXJtdXRhdGlvbnMpXG5vdXRwdXRfc3Vic2V0IDwtIG91dHB1dCB8PiBcbiAgZmlsdGVyKHBlcm11dGF0aW9uICVpbiUgMDozKSBcblxuIyBjb21wdXRlIGdyb3VwIG1lYW5zIGZvciBjcm9zc2JhcnNcbm1lYW5zIDwtIG91dHB1dF9zdWJzZXQgfD5cbiAgZ3JvdXBfYnkocGVybXV0YXRpb24sIHNodWZmbGVkX2dyb3VwKSB8PlxuICBzdW1tYXJpc2UobWVhbl93dHAgPSBtZWFuKHd0cF9maW5hbCksIC5ncm91cHMgPSBcImRyb3BcIilcblxuIyBwbG90XG5vdXRwdXRfc3Vic2V0IHw+IFxuICBnZ3Bsb3QobWFwcGluZyA9IGFlcyh4ID0gc2h1ZmZsZWRfZ3JvdXAsIHkgPSB3dHBfZmluYWwsIGNvbG9yID0gb3JpZ2luYWxfZ3JvdXApKSArXG4gIGdlb21faml0dGVyKGFscGhhID0gLjUsIHdpZHRoID0gMC4zLCBoZWlnaHQgPSAwKSArXG4gIGdlb21fY3Jvc3NiYXIoXG4gIGRhdGEgPSBtZWFucyxcbiAgbWFwcGluZyA9IGFlcyh4ID0gc2h1ZmZsZWRfZ3JvdXAsIHkgPSBtZWFuX3d0cCwgeW1pbiA9IG1lYW5fd3RwLCB5bWF4ID0gbWVhbl93dHApLFxuICBpbmhlcml0LmFlcyA9IEZBTFNFLFxuICB3aWR0aCA9IDAuNyxcbiAgY29sb3IgPSBcImJsYWNrXCIsXG4gIGxpbmV3aWR0aCA9IDEgIFxuKSArXG4gIGZhY2V0X3dyYXAobnJvdyA9IDEsIHZhcnMocGVybXV0YXRpb24pLCBsYWJlbGxlciA9IGxhYmVsbGVyKHBlcm11dGF0aW9uID0gYyhcbiAgICBgMGAgPSBcIk9ic2VydmVkIERhdGFcIixcbiAgICBgMWAgPSBcIlBlcm11dGF0aW9uIDFcIixcbiAgICBgMmAgPSBcIlBlcm11dGF0aW9uIDJcIixcbiAgICBgM2AgPSBcIlBlcm11dGF0aW9uIDNcIlxuICApKSkgK1xuICBzY2FsZV9jb2xvcl9tYW51YWwoXG4gICAgdmFsdWVzID0gYyhcbiAgICAgIFwiQlwiID0gXCIjZjZhMjdiXCIsXG4gICAgICBcIkFcIiA9IFwiIzdiY2ZmNlwiXG4gICAgKVxuICApICtcbiAgdGhlbWVfYncoKSArXG4gIGxhYnMoXG4gICAgdGl0bGUgPSBcIlZpc3VhbGl6aW5nIE9ic2VydmVkIGFuZCBQZXJtdXRlZCBHcm91cCBBc3NpZ25tZW50c1wiLFxuICAgIHN1YnRpdGxlID0gXCJGaXJzdCBwYW5lbCBzaG93cyB0aGUgcmVhbCBkYXRhOyByZW1haW5pbmcgcGFuZWxzIHNob3cgc2h1ZmZsZWQgbGFiZWxzXCIsXG4gICAgY2FwdGlvbiA9IFwiQmxhY2sgaG9yaXpvbnRhbCBiYXIgc2hvd3MgZ3JvdXAgbWVhblwiLFxuICAgIHggPSBcIlwiLFxuICAgIHkgPSBcIldpbGxpbmduZXNzIHRvIFBheVwiLFxuICAgIGNvbG9yID0gXCJPcmlnaW5hbCBHcm91cFwiXG4gICkgK1xuICB0aGVtZV9idygpICtcbiAgdGhlbWUoXG4gICAgcGxvdC50aXRsZSAgICAgICA9IGVsZW1lbnRfdGV4dChzaXplID0gMTYsIGZhY2UgPSBcImJvbGRcIiksIFxuICAgIHBsb3Quc3VidGl0bGUgICAgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0KSwgICAgICAgICAgICAgICAgICBcbiAgICBheGlzLnRpdGxlICAgICAgID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksICAgICAgICAgICAgICAgICAgXG4gICAgYXhpcy50ZXh0ICAgICAgICA9IGVsZW1lbnRfdGV4dChzaXplID0gMTApLCAgICAgICAgICAgICAgICAgIFxuICAgIGxlZ2VuZC50ZXh0ICAgICAgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEwKSwgICAgICAgICAgICAgICAgICBcbiAgICBsZWdlbmQudGl0bGUgICAgID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksXG4gICAgcGxvdC5jYXB0aW9uICAgICA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLFxuICAgIHN0cmlwLnRleHQgICAgICAgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSxcbiAgICBsZWdlbmQucG9zaXRpb24gID0gXCJib3R0b21cIlxuICApICJ9
</script>
</div>
<p>Next, we’ll calculate the difference in mean willingness to pay between the two groups for every permutation. This value, which we’ll call <strong>null_diff</strong>, reflects the difference between the shuffled (randomized) group assignments in that permutation — not the real experimental conditions. Click <strong>Run Code</strong> to generate <strong>null_diff</strong> for all permutations</p>
<div>
<div id="webr-8" class="exercise-cell">

</div>
<script type="webr-8-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIHR1cm4gbGlzdCBpbnRvIGEgZGZcbmRmX3Blcm11dGF0aW9ucyA8LSBwZXJtdXRhdGlvbl9saXN0IHw+XG4gICMgQ29tcHV0ZSBncm91cCBtZWFucyBmb3IgZWFjaCBwZXJtdXRhdGlvblxuICBsYXBwbHkoZnVuY3Rpb24oZGYpIHtcbiAgICBkZiB8PlxuICAgICAgZ3JvdXBfYnkoc2h1ZmZsZWRfZ3JvdXApIHw+XG4gICAgICBzdW1tYXJpc2UobWVhbl91bmRlcl9udWxsID0gbWVhbih3dHBfZmluYWwpLCAuZ3JvdXBzID0gXCJkcm9wXCIpXG4gIH0pIHw+XG4gIGJpbmRfcm93cyguaWQgPSBcInBlcm11dGF0aW9uXCIpXG5cbiMgY29tcHV0ZSBtZWFuIGRpZmZlcmVuY2UgaW4gZWFjaCBwZXJtdXRhdGlvblxubWVhbl9kaWZmX3Blcm11dGF0aW9ucyA8LSBcbiAgZGZfcGVybXV0YXRpb25zIHw+XG4gIHBpdm90X3dpZGVyKG5hbWVzX2Zyb20gPSBzaHVmZmxlZF9ncm91cCwgdmFsdWVzX2Zyb20gPSBtZWFuX3VuZGVyX251bGwpIHw+XG4gIG11dGF0ZShudWxsX2RpZmYgPSBgQmAgLSBgQWApIHw+XG4gIHNlbGVjdChwZXJtdXRhdGlvbiwgbnVsbF9kaWZmKVxuXG5tZWFuX2RpZmZfcGVybXV0YXRpb25zIHw+IGhlYWQobiA9IDEwKSJ9
</script>
</div>
<p>Now, we can visualize the expected difference in willingness to pay between the two groups under the null hypothesis.</p>
<div>
<div id="webr-9" class="exercise-cell">

</div>
<script type="webr-9-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIGdldCBjZW50cmFsIDk1JSBjdXRvZmZzXG5xX2xvd2VyIDwtIHF1YW50aWxlKG1lYW5fZGlmZl9wZXJtdXRhdGlvbnMkbnVsbF9kaWZmLCAwLjAyNSlcbnFfdXBwZXIgPC0gcXVhbnRpbGUobWVhbl9kaWZmX3Blcm11dGF0aW9ucyRudWxsX2RpZmYsIDAuOTc1KVxuXG4jIGJ1aWxkIGEgZGVuc2l0eSBkYXRhIGZyYW1lXG5kZW5zX29iaiAgPC0gZGVuc2l0eShtZWFuX2RpZmZfcGVybXV0YXRpb25zJG51bGxfZGlmZilcbmRlbnNpdHlfZGYgPC0gZGF0YS5mcmFtZSh4ID0gZGVuc19vYmokeCwgeSA9IGRlbnNfb2JqJHkpXG5cbiMgbWFrZSB0aGUgcGxvdFxubWVhbl9kaWZmX3Blcm11dGF0aW9ucyB8PiBcbiAgZ2dwbG90KG1hcHBpbmcgPSBhZXMoeCA9IG51bGxfZGlmZikpICtcbiAgIyBmdWxsIGRlbnNpdHlcbiAgZ2VvbV9kZW5zaXR5KGZpbGwgPSBcIiNFQ0VDRUNcIiwgYWxwaGEgPSAwLjUpICtcbiAgIyBzaGFkZWQgbWlkZGxlIDk1JVxuICBnZW9tX2FyZWEoXG4gICAgZGF0YSA9IGRlbnNpdHlfZGYgfD4gZmlsdGVyKHggPj0gcV9sb3dlciwgeCA8PSBxX3VwcGVyKSxcbiAgICBtYXBwaW5nID0gYWVzKHggPSB4LCB5ID0geSksXG4gICAgZmlsbCA9IFwiI0Q0RDRENFwiLFxuICAgIGFscGhhID0gMC42XG4gICkgK1xuICAjIGFubm90YXRpb24gdGV4dFxuICBhbm5vdGF0ZShcbiAgICBcInRleHRcIixcbiAgICB4ID0gMCxcbiAgICB5ID0gbWF4KGRlbnNpdHlfZGYkeSkgKiAwLjEyNSxcbiAgICBsYWJlbCA9IHBhc3RlMChcIklmIEjigoAgaXMgdHJ1ZSxcXG7iiYg5NSUgb2YgcGVybXV0ZWQgZ3JvdXAgXFxuZGlmZmVyZW5jZXMgYXJlIGV4cGVjdGVkIFxcbnRvIGZhbGwgaW4gdGhpcyByZWdpb25cIlxuICAgICAgICAgICAgICAgICksXG4gICAgZmFtaWx5ICAgID0gXCJzYW5zXCIsXG4gICAgc2l6ZSAgICAgID0gNCxcbiAgICBsaW5laGVpZ2h0PSAwLjksXG4gICAgaGp1c3QgICAgID0gMC41XG4gICkgK1xuICBsYWJzKFxuICAgIHRpdGxlID0gXCJFbXBpcmljYWwgTnVsbCBEaXN0cmlidXRpb24gb2YgQ29uZGl0aW9uIERpZmZlcmVuY2VzXCIsXG4gICAgeCAgICAgPSBcIkRpZmZlcmVuY2UgaW4gd2lsbGluZ25lc3MgdG8gcGF5IGJldHdlZW4gdGhlIHR3byBjb25kaXRpb25zIChCIC0gQSlcIixcbiAgICB5ICAgICA9IFwiRGVuc2l0eVwiXG4gICkgK1xuICB0aGVtZV9idygpIn0=
</script>
</div>
<blockquote class="blockquote">
<p>Earlier, you calculated the observed difference in willingness to pay between your two selected conditions. Locate that value on the x‑axis of the null distribution and consider: How extreme is this difference compared to what we would expect if the null hypothesis were true?</p>
</blockquote>
</section>
<section id="step-5-query-the-permutations" class="level2">
<h2 class="anchored" data-anchor-id="step-5-query-the-permutations">Step 5: Query the permutations</h2>
<p>Our goal is to answer:</p>
<blockquote class="blockquote">
<p>In how many of the permuted samples is the calculated difference between groups as extreme (or more extreme) than our observed difference between groups?</p>
</blockquote>
<p><strong>What’s the intuition?</strong></p>
<ul>
<li><p>If the <strong>null hypothesis</strong> is true, there is <strong>no real difference</strong> in average willingness to pay between the two groups.</p></li>
<li><p>Any difference we see is <strong>purely due to chance</strong>.</p></li>
<li><p>By shuffling the group labels thousands of times, we create a <strong>null world</strong> where the true difference is zero.</p></li>
<li><p>Each permutation shows us a <strong>difference we might expect by random chance</strong>.</p></li>
</ul>
<p><strong>How do we measure extremeness?</strong></p>
<ul>
<li><p>Because we are not predicting which group should have the higher mean, we use the <strong>absolute value of the differences</strong>.</p></li>
<li><p>A permutation is considered <strong>“extreme”</strong> if its absolute difference is <strong>greater than or equal to</strong> the absolute observed difference.</p></li>
</ul>
<p><strong>What we’ll do:</strong></p>
<ol type="1">
<li><p><strong>Mark each permutation</strong> as “extreme” if the absolute difference in means is at least as large as the observed difference.</p></li>
<li><p><strong>Count the extreme cases</strong> to determine the fraction of permutations that are as extreme or more extreme than what we observed.</p></li>
</ol>
<p>Press <strong>Run Code</strong> to tally the number of extreme samples.</p>
<div>
<div id="webr-10" class="exercise-cell">

</div>
<script type="webr-10-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5tZWFuX2RpZmZfcGVybXV0YXRpb25zIDwtIFxuICBtZWFuX2RpZmZfcGVybXV0YXRpb25zICB8PiBcbiAgbXV0YXRlKGV4dHJlbWVfZGlmZiA9IGNhc2Vfd2hlbihhYnMobnVsbF9kaWZmKSA+PSBhYnMob2JzZXJ2ZWRfZGlmZikgfiBcImV4dHJlbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gXCJub3QgZXh0cmVtZVwiKSkgXG5cbiMgdGFsbHkgdGhlIGV4dHJlbWUgdmVyc3VzIG5vdCBleHRyZW1lIHBlcm11dGF0aW9ucy5cbm1lYW5fZGlmZl9wZXJtdXRhdGlvbnMgfD4gY291bnQoZXh0cmVtZV9kaWZmKSJ9
</script>
</div>
<p>&gt;What proportion of the permuted differences are as extreme as our observed difference?</p>
<p>From our tally, we can compute the <strong>fraction of permutations</strong> where the absolute difference in means is <strong>at least as large as the observed difference</strong> between the real groups.</p>
<p>This fraction is our <strong>empirical <em>p</em>‑value</strong> — the probability of seeing a difference this extreme <strong>if the null hypothesis were true</strong>.</p>
<p>A <strong>small <em>p</em>‑value</strong> means that such an extreme result would be <strong>unlikely by chance alone</strong>, providing <strong>evidence against the null</strong> and suggesting a possible real difference between the groups.</p>
<div>
<div id="webr-11" class="exercise-cell">

</div>
<script type="webr-11-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIGNvdW50IGV4dHJlbWUgcGVybXV0YXRpb25zICh3aGVyZSB8bnVsbF9kaWZmfCDiiaUgfG9ic2VydmVkX2RpZmZ8KVxucF92YWx1ZSA8LSBtZWFuKGFicyhtZWFuX2RpZmZfcGVybXV0YXRpb25zJG51bGxfZGlmZikgPj0gYWJzKG9ic2VydmVkX2RpZmYpKVxuXG4jIGZvcm1hdCBmb3IgcmVwb3J0aW5nXG5jYXQoc3ByaW50ZihcInAgPSAlLjNmICglLjFmJSUgb2YgJWQgcGVybXV0YXRpb25zKVwiLCBcbiAgICAgICAgICAgIHBfdmFsdWUsIFxuICAgICAgICAgICAgMTAwKnBfdmFsdWUsIFxuICAgICAgICAgICAgbnJvdyhtZWFuX2RpZmZfcGVybXV0YXRpb25zKSkpIn0=
</script>
</div>
</section>
<section id="step-6-compute-the-standard-deviation-of-the-null-distribution" class="level2">
<h2 class="anchored" data-anchor-id="step-6-compute-the-standard-deviation-of-the-null-distribution">Step 6: Compute the standard deviation of the null distribution</h2>
<p>The <strong>standard error (SE)</strong> reflects how much the mean difference in willingness to pay would <strong>vary by chance</strong> due to random sampling.</p>
<p>In a permutation test, we can estimate this by calculating the <strong>standard deviation of the mean differences</strong> across all 5,000 shuffled datasets. This gives us the <strong>spread of differences we’d expect under the null hypothesis</strong>, showing the typical variation if there were <strong>no real effect</strong>.</p>
<p>Press <strong>Run Code</strong> to compute the standard error.</p>
<div>
<div id="webr-12" class="exercise-cell">

</div>
<script type="webr-12-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5zZSA8LVxuICBtZWFuX2RpZmZfcGVybXV0YXRpb25zIHw+IFxuICBzdW1tYXJpemUoc2RfbnVsbF9kaXN0ID0gc2QobnVsbF9kaWZmKSkgfD4gXG4gIHB1bGwoKVxuXG4jIGZvcm1hdCBmb3IgcmVwb3J0aW5nXG5jYXQoXCJTdGFuZGFyZCBFcnJvciAoU0UpIChpLmUuLCBTRCBvZiBudWxsIGRpc3RyaWJ1dGlvbik6XCIsIFxuICAgIHNwcmludGYoXCIlLjJmXCIsIHNlKSwgXG4gICAgXCJcXG5cIikifQ==
</script>
</div>
</section>
<section id="step-7-calculate-a-test-statistic" class="level2">
<h2 class="anchored" data-anchor-id="step-7-calculate-a-test-statistic">Step 7: Calculate a test-statistic</h2>
<p>&gt;How many standard errors away from zero is our observed difference between the two real groups?</p>
<p>To judge how unusual our observed difference is under the null hypothesis (which assumes <strong>no true difference</strong>), we calculate a <strong>standardized test statistic</strong>:</p>
<ol type="1">
<li><p>Take the <strong>observed difference</strong> in willingness to pay between the two groups (<span class="math inline">\(\bar{x}_B - \bar{x}_A\)</span>).</p></li>
<li><p>Subtract the <strong>null hypothesis value</strong> (0).</p></li>
<li><p>Divide by the <strong>standard error</strong> from the permutation distribution.</p></li>
</ol>
<p>This standardized value tells us <strong>how many standard errors the observed difference is from the null</strong>, which is the foundation for significance testing.</p>
<p>The formula for the standardized test statistic is:</p>
<p><span class="math display">\[
t = \frac{(\bar{x}_B - \bar{x}_A) - 0}{SE}
\]</span></p>
<p>Press <strong>Run Code</strong> on the code chunk below to compute the standardized test statistic.</p>
<div>
<div id="webr-13" class="exercise-cell">

</div>
<script type="webr-13-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5zdGRfdGVzdF9zdGF0aXN0aWMgPSBvYnNlcnZlZF9kaWZmL3NlXG4gICAgXG4jIGZvcm1hdCBmb3IgcmVwb3J0aW5nXG5jYXQoXCJTdGFuZGFyZGl6ZWQgdGVzdCBzdGF0aXN0aWM6XCIsIFxuICAgIHNwcmludGYoXCIlLjJmXCIsIHN0ZF90ZXN0X3N0YXRpc3RpYyksIFxuICAgIFwiXFxuXCIpIn0=
</script>
</div>
<p>We can visualize where our <strong>observed standardized test statistic</strong> falls relative to the <strong>null distribution</strong> — the distribution of standardized differences we would expect if there were truly <strong>no difference</strong> between the groups.</p>
<p>The shaded middle region represents the <strong>95% of null test statistics</strong> that are closest to zero. If our observed statistic lands <strong>far in the tails</strong>, it’s unlikely under the null hypothesis — exactly what a <em>p</em>‑value quantifies.</p>
<p>Press <strong>Run Code</strong> on the code chunk below to produce the graphic.</p>
<div>
<div id="webr-14" class="exercise-cell">

</div>
<script type="webr-14-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG4jIG9ic2VydmVkIHN0YW5kYXJkaXplZCB0ZXN0IHN0YXRpc3RpY1xuc3RkX3Rlc3Rfc3RhdGlzdGljICA8LSBvYnNlcnZlZF9kaWZmIC8gc2VcblxuIyBudWxsIHN0YXRpc3RpY3Mgc3RhbmRhcmRpemVkXG5zdGRfbWVhbl9kaWZmX3Blcm11dGF0aW9ucyA8LSBcbiAgbWVhbl9kaWZmX3Blcm11dGF0aW9ucyB8PiBcbiAgbXV0YXRlKHN0ZF9udWxsX2RpZmYgPSBudWxsX2RpZmYgLyBzZSlcblxuIyBjZW50cmFsIDk1JSBjdXRvZmZzXG5xX2xvd2VyIDwtIHF1YW50aWxlKHN0ZF9tZWFuX2RpZmZfcGVybXV0YXRpb25zJHN0ZF9udWxsX2RpZmYsIDAuMDI1KVxucV91cHBlciA8LSBxdWFudGlsZShzdGRfbWVhbl9kaWZmX3Blcm11dGF0aW9ucyRzdGRfbnVsbF9kaWZmLCAwLjk3NSlcblxuIyBkZW5zaXR5IGRhdGEgZnJhbWVcbmRlbnNfb2JqICA8LSBkZW5zaXR5KHN0ZF9tZWFuX2RpZmZfcGVybXV0YXRpb25zJHN0ZF9udWxsX2RpZmYpXG5kZW5zaXR5X2RmIDwtIGRhdGEuZnJhbWUoeCA9IGRlbnNfb2JqJHgsIHkgPSBkZW5zX29iaiR5KVxuXG4jIGR5bmFtaWNhbGx5IGNyZWF0ZSBvYnNlcnZlZCBsYWJlbFxubGFiZWxfZGYgPC0gZGF0YS5mcmFtZShcbiAgeCA9IHN0ZF90ZXN0X3N0YXRpc3RpYyxcbiAgeSA9IG1heChkZW5zaXR5X2RmJHkpICogMC42LFxuICBsYWJlbCA9IHNwcmludGYoXG4gICAgXCJPYnNlcnZlZCBcXG5zdGFuZGFyZGl6ZWQgXFxudGVzdCBzdGF0aXN0aWNcXG4gJS4yZiAvICUuMmYgPSAlLjJmXCIsXG4gICAgb2JzZXJ2ZWRfZGlmZiwgc2UsIHN0ZF90ZXN0X3N0YXRpc3RpY1xuICApXG4pXG5cbiMgbWFrZSB0aGUgcGxvdFxuZ2dwbG90KHN0ZF9tZWFuX2RpZmZfcGVybXV0YXRpb25zLCBhZXMoeCA9IHN0ZF9udWxsX2RpZmYpKSArXG4gIGdlb21fZGVuc2l0eShmaWxsID0gXCIjRUNFQ0VDXCIsIGFscGhhID0gMC41KSArXG4gIGdlb21fYXJlYShcbiAgICBkYXRhID0gZGVuc2l0eV9kZiB8PiBmaWx0ZXIoeCA+PSBxX2xvd2VyLCB4IDw9IHFfdXBwZXIpLFxuICAgIG1hcHBpbmcgPSBhZXMoeCA9IHgsIHkgPSB5KSxcbiAgICBmaWxsID0gXCIjRDRENEQ0XCIsXG4gICAgYWxwaGEgPSAwLjZcbiAgKSArXG4gIGFubm90YXRlKFxuICAgIFwidGV4dFwiLFxuICAgIHggPSAwLFxuICAgIHkgPSBtYXgoZGVuc2l0eV9kZiR5KSAqIDAuMTI1LFxuICAgIGxhYmVsID0gcGFzdGUwKFwiSWYgSOKCgCBpcyB0cnVlLFxcbuKJiDk1JSBvZiBzdGFuZGFyZGl6ZWQgXFxudGVzdCBzdGF0aXN0aWNzXFxud2lsbCBmYWxsIGluIHRoaXMgcmVnaW9uXCIpLFxuICAgIGZhbWlseSA9IFwic2Fuc1wiLFxuICAgIHNpemUgPSA0LFxuICAgIGxpbmVoZWlnaHQgPSAwLjksXG4gICAgaGp1c3QgPSAwLjVcbiAgKSArXG4gIGFubm90YXRlKFxuICAgIFwic2VnbWVudFwiLFxuICAgIHggPSBzdGRfdGVzdF9zdGF0aXN0aWMsXG4gICAgeGVuZCA9IHN0ZF90ZXN0X3N0YXRpc3RpYyxcbiAgICB5ID0gbWF4KGRlbnNpdHlfZGYkeSkgKiAwLjUsXG4gICAgeWVuZCA9IDAsXG4gICAgYXJyb3cgPSBhcnJvdyhsZW5ndGggPSB1bml0KDAuMiwgXCJjbVwiKSwgdHlwZSA9IFwiY2xvc2VkXCIpLFxuICAgIGNvbG9yID0gXCIjN2JjMDQzXCJcbiAgKSArXG4gIGdlb21fbGFiZWwoXG4gICAgZGF0YSA9IGxhYmVsX2RmLCAgICAgICBcbiAgICBtYXBwaW5nID0gYWVzKHggPSB4LCB5ID0geSwgbGFiZWwgPSBsYWJlbCksXG4gICAgaW5oZXJpdC5hZXMgPSBGQUxTRSxcbiAgICBmaWxsID0gYWxwaGEoXCJ3aGl0ZVwiKSwgXG4gICAgY29sb3IgPSBcIiM3YmMwNDNcIixcbiAgICBmb250ZmFjZSA9IFwiYm9sZFwiLFxuICAgIGZhbWlseSA9IFwic2Fuc1wiLFxuICAgIHNpemUgPSA0XG4gICkgK1xuICB4bGltKG1pbihkZW5zaXR5X2RmJHgpIC0gMSwgbWF4KGRlbnNpdHlfZGYkeCkgKyAxKSArXG4gIGxhYnMoXG4gICAgdGl0bGUgPSBcIkVtcGlyaWNhbCBOdWxsIERpc3RyaWJ1dGlvbiBvZiBDb25kaXRpb24gRGlmZmVyZW5jZXMgKFN0YW5kYXJkaXplZClcIixcbiAgICB4ID0gXCJTdGFuZGFyZGl6ZWQgbnVsbCB0ZXN0IHN0YXRpc3RpYyAoZGlmZmVyZW5jZSBiZXR3ZWVuIGNvbmRpdGlvbnMgLyBTRSlcIixcbiAgICB5ID0gXCJEZW5zaXR5XCJcbiAgKSArXG4gIHRoZW1lX2J3KCkifQ==
</script>
</div>
<p>On this graph, the darker gray area of the sampling distribution under the null denotes the critical boundaries, marking the middle 95% of the distribution. The green line shows the calculated standardized test statistic for the difference in willingness to pay between the two conditions that you selected, measured in standard errors from the null hypothesis value (0 — i.e., no difference between groups).</p>
<ul>
<li><p>If the green line falls <strong>within</strong> the darker grey area, we <strong>cannot reject the null hypothesis</strong> (we lack evidence that the group means differ).</p></li>
<li><p>If the green line is <strong>outside</strong> the darker grey boundaries, we <strong>can reject the null hypothesis</strong> (indicating a significant difference between groups). In this example, such a result would suggest that the data visualization shown to participants affects their perceived willingness to pay.</p></li>
</ul>
<blockquote class="blockquote">
<p>Can the null hypothesis be rejected for the comparison of your selected conditions?</p>
</blockquote>
</section>
<section id="step-8-test-the-hypothesis-with-an-independent-samples-t-test" class="level2">
<h2 class="anchored" data-anchor-id="step-8-test-the-hypothesis-with-an-independent-samples-t-test">Step 8: Test the hypothesis with an independent samples t-test</h2>
<p>To test whether there’s a meaningful difference in means between two groups, we have two primary approaches: a non-parametric approach (e.g., the permutation test we just worked through) and a parametric/theory-based approach.</p>
<p>A <strong>two-sample <em>t</em>-test</strong> is a parametric approach, meaning it relies on certain assumptions about the data:</p>
<ul>
<li><p><strong>Normality</strong>: The sampling distribution of the difference in means should be approximately normal. This assumption is generally met if each group’s data is roughly normal or if the sample sizes are large enough (thanks to the central limit theorem).</p></li>
<li><p><strong>Equal Variance</strong>: The variability (spread) in each group should be approximately equal.</p></li>
</ul>
<p>If these assumptions are reasonable for your data, an independent samples <em>t</em>-test can be a powerful tool. Here’s how the <em>t</em>-test works:</p>
<ol type="1">
<li><p><strong>Calculate the Mean Difference</strong>: First, we calculate the difference in means between the two groups.</p></li>
<li><p><strong>Estimate the Standard Error</strong>: Using the sample standard deviations and sizes of each group, we estimate the standard error, which tells us how much we’d expect the means to vary just by chance.</p></li>
<li><p><strong>Compute the <em>t</em>-statistic</strong>: The <em>t</em>-statistic measures how many standard errors the observed difference is from zero (our null hypothesis value, assuming no difference).</p></li>
</ol>
<p>The formula for the t-statistic is:</p>
<p><span class="math display">\[
t = \frac{(\bar{x}_B - \bar{x}_A) - 0}{SE}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\bar{x}_A\)</span> and <span class="math inline">\(\bar{x}_B\)</span> are the sample means for Groups A and B, respectively. The 0 subtracted in the numerator represents the null hypothesis value (i.e., no group difference).</p></li>
<li><p><span class="math inline">\(SE\)</span> is the standard error of the difference, calculated from the sample standard deviations and sample sizes of the groups. <span class="math inline">\(SE = \sqrt{\frac{s_A^2}{n_A} + \frac{s_B^2}{n_B}}\)</span>, where:<span class="math inline">\(s_A\)</span> and <span class="math inline">\(s_B\)</span> are the sample standard deviations for Groups A and B, <span class="math inline">\(n_A\)</span> and <span class="math inline">\(n_B\)</span> are the sample sizes for Groups A and B.</p></li>
</ul>
<p>Press <strong>Run Code</strong> on the code chunk below to compute the test.</p>
<div>
<div id="webr-15" class="exercise-cell">

</div>
<script type="webr-15-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5teV9ncm91cHMgfD4gXG4gIHRfdGVzdCh3dHBfZmluYWwgfiBncm91cCwgXG4gICAgICAgICB2YXIuZXF1YWwgPSBUUlVFLFxuICAgICAgICAgb3JkZXIgPSBjKFwiQlwiLCBcIkFcIiksXG4gICAgICAgICBhbHRlcm5hdGl2ZSA9IFwidHdvLXNpZGVkXCIpIn0=
</script>
</div>
<p>Notice the similarity between the <em>t</em>-statistic that we created using the permutations and the <em>t</em>-statistic in the <strong>t_test</strong> output (labeled statistic). Also, notice the similarity between the <em>p</em>-value that we created using the permutations and the <em>p</em>-value in the <strong>t_test</strong> output (labeled p_value).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here’s a breakdown of the code for the <code>t_test()</code> function in this context:</p>
<ul>
<li><p><code>wtp_final ~ group</code>: This formula indicates that we are testing the difference in the mean values of willingness to pay between the groups defined by group.</p></li>
<li><p><code>var.equal = TRUE</code>: This specifies that the variances of the two groups are assumed to be equal. If set to FALSE, the function would perform Welch’s t-test, which does not assume equal variances.</p></li>
<li><p><code>order = c("B", "A")</code>: This specifies the order in which the groups are subtracted. In this case, the mean of group A is subtracted from the mean of group B.</p></li>
<li><p><code>alternative = "two-sided"</code>: This specifies that the test is two-sided, meaning we are testing if there’s a significant difference in means, regardless of the direction (either group A is greater than group B or vice versa).</p></li>
</ul>
</div>
</div>
</section>
<section id="step-9-test-the-hypothesis-with-a-simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="step-9-test-the-hypothesis-with-a-simple-linear-regression">Step 9: Test the hypothesis with a simple linear regression</h2>
<p>We can equivalently specify the two sample <em>t</em>-test as a simple linear regression. Here, we regress willingness to pay on the dummy coded indicator designed to compare Group B to Group A.</p>
<div>
<div id="webr-16" class="exercise-cell">

</div>
<script type="webr-16-contents">
eyJhdHRyIjp7ImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5zbHIgPC0gbG0od3RwX2ZpbmFsIH4gZ3JvdXBCLCBkYXRhID0gbXlfZ3JvdXBzKVxuc2xyIHw+IHRpZHkoY29uZi5pbnQgPSBUUlVFLCBjb25mLmxldmVsID0gLjk1KSJ9
</script>
</div>
<p>Notice that the independent sample <em>t</em>-test and the simple linear regression produce IDENTICAL results for the difference in willingness to pay between the two groups. A two sample <em>t</em>-test and a simple linear regression in which the outcome is regressed on a grouping variable are equivalent models — you obtain the same result. In the regression output, the intercept gives the estimated mean willingness to pay for Group A, and the coefficient for groupB represents the difference in means (Group B − Group A).</p>
</section>
</section>
<section id="wrap-up" class="level1">
<h1>Wrap-up</h1>
<p>Congratulations — you’ve now walked through a complete null hypothesis significance test using permutations, and you’ve seen how it aligns with traditional parametric methods. In this activity, you:</p>
<ol type="1">
<li><p><strong>Explored and visualized</strong> the observed group means with 95% confidence intervals to see how participants’ willingness to pay varied by visualization type.</p></li>
<li><p><strong>Built a null distribution</strong> by shuffling labels 5,000 times, creating “permutation intervals” that show what mean differences look like purely by chance under the null hypothesis.</p></li>
<li><p><strong>Quantified extremeness</strong> by calculating the proportion of permuted differences at least as large as the observed difference — your empirical <em>p</em>-value.</p></li>
<li><p><strong>Standardized the test statistic</strong> (difference ÷ null SD) to see how many “standard errors” away from zero your result lies.</p></li>
<li><p><strong>Verified your findings</strong> with a parametric two‐sample <em>t</em>-test and an equivalent linear regression, confirming that all approaches yield the same conclusion when assumptions hold.</p></li>
</ol>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key takeaways</h2>
<ul>
<li><p><strong>Permutation tests</strong> make minimal assumptions: they simply ask “what would random chance produce?”</p></li>
<li><p><strong>Parametric tests</strong> (t-tests, regression) rely on normality and equal‐variance assumptions but are often faster and more familiar.</p></li>
<li><p>When both methods agree, you can be confident in your inference; when they diverge, it’s a signal to examine your data and assumptions more closely.</p></li>
</ul>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next steps</h2>
<ul>
<li><p><strong>Try different comparisons.</strong> Repeat the analysis for other pairs of visualization types (e.g., CI vs.&nbsp;CI_rescaled) and compare effect sizes.</p></li>
<li><p><strong>Vary the number of permutations.</strong> See how the stability of your <em>p</em>-value and null‐distribution estimates changes with 1,000, 10,000, or more replicates.</p></li>
<li><p><strong>Explore one‐sided tests.</strong> If you have a directional hypothesis (e.g., HOPS will increase willingness to pay), adapt your permutation counting accordingly.</p></li>
</ul>
<p>By contrasting observed‐data uncertainty (confidence intervals) with null‐model variability (permutation intervals), you’ve gained a deeper intuition for how <em>p</em>-values and other core statistics arise — and, crucially, you’ve de-mystified some of the most confusing concepts in statistics (like <em>p</em>-values) by actually seeing and calculating them via simulation. You now have a flexible, assumption-lean tool in your toolkit to assess group differences — and a clear understanding of how it connects to the familiar <em>t</em>-test and regression frameworks. Happy analyzing!</p>


<script type="webr-data">
eyJvcHRpb25zIjp7ImJhc2VVcmwiOiJodHRwczovL3dlYnIuci13YXNtLm9yZy92MC41LjQvIn0sInBhY2thZ2VzIjp7InBrZ3MiOlsiZXZhbHVhdGUiLCJrbml0ciIsImh0bWx0b29scyIsImhlcmUiLCJicm9vbSIsImluZmVyIiwicHVycnIiLCJ0aWR5dmVyc2UiLCJybWFya2Rvd24iXSwicmVwb3MiOltdfSwicmVuZGVyX2RmIjoicGFnZWQtdGFibGUifQ==
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xNiIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTY7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xNiIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzE2ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMTYtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xNi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xNiA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMTYsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xNSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTU7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xNSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzE1ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMTUtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xNS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xNSA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMTUsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xNCIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTQ7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xNCIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzE0ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMTQtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xNC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xNCA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMTQsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xMyIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTM7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xMyIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzEzID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMTMtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xMy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xMyA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMTMsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xMiIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTI7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xMiIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzEyID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMTItY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xMi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xMiA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMTIsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xMSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTE7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xMSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzExID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMTEtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xMS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xMSA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMTEsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0xMCIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMTA7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xMCIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzEwID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMTAtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xMC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8xMCA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMTAsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC05IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV85O1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIn0seyJjZWxsTmFtZSI6IndlYnItOSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzkgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici05LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItOS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV85ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl85LCB7fSk7XG4ifSx7ImNlbGxOYW1lIjoid2Vici13aWRnZXQtOCIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfODtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLTgiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl84ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItOC1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTgtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfOCA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfOCwge30pO1xuIn0seyJjZWxsTmFtZSI6IndlYnItd2lkZ2V0LTciLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJ7XG4gIC8vIFdhaXQgZm9yIG91dHB1dCB0byBiZSB3cml0dGVuIHRvIHRoZSBET00sIHRoZW4gdHJpZ2dlciB3aWRnZXQgcmVuZGVyaW5nXG4gIGF3YWl0IF93ZWJyX3ZhbHVlXzc7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici03IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfNyA9IHtcbiAgY29uc3QgeyBXZWJSRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLTctY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici03LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzcgPSB3ZWJST2pzLnByb2Nlc3MoX3dlYnJfZWRpdG9yXzcsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC02IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV82O1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIn0seyJjZWxsTmFtZSI6IndlYnItNiIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzYgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici02LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItNi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV82ID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl82LCB7fSk7XG4ifSx7ImNlbGxOYW1lIjoid2Vici13aWRnZXQtNSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfNTtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLTUiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl81ID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItNS1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTUtY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfNSA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfNSwge30pO1xuIn0seyJjZWxsTmFtZSI6IndlYnItd2lkZ2V0LTQiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJ7XG4gIC8vIFdhaXQgZm9yIG91dHB1dCB0byBiZSB3cml0dGVuIHRvIHRoZSBET00sIHRoZW4gdHJpZ2dlciB3aWRnZXQgcmVuZGVyaW5nXG4gIGF3YWl0IF93ZWJyX3ZhbHVlXzQ7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici00IiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfNCA9IHtcbiAgY29uc3QgeyBXZWJSRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLTQtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici00LWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzQgPSB3ZWJST2pzLnByb2Nlc3MoX3dlYnJfZWRpdG9yXzQsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXdpZGdldC0zIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoie1xuICAvLyBXYWl0IGZvciBvdXRwdXQgdG8gYmUgd3JpdHRlbiB0byB0aGUgRE9NLCB0aGVuIHRyaWdnZXIgd2lkZ2V0IHJlbmRlcmluZ1xuICBhd2FpdCBfd2Vicl92YWx1ZV8zO1xuICBpZiAod2luZG93LkhUTUxXaWRnZXRzKSB7XG4gICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpO1xuICB9XG4gIGlmICh3aW5kb3cuUGFnZWRUYWJsZURvYykge1xuICAgIHdpbmRvdy5QYWdlZFRhYmxlRG9jLmluaXRBbGwoKTtcbiAgfVxufVxuIn0seyJjZWxsTmFtZSI6IndlYnItMyIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJzb3VyY2UiOiJ2aWV3b2YgX3dlYnJfZWRpdG9yXzMgPSB7XG4gIGNvbnN0IHsgV2ViUkV4ZXJjaXNlRWRpdG9yLCBiNjREZWNvZGUgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici0zLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHdlYnItMy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBXZWJSRXhlcmNpc2VFZGl0b3Iod2ViUk9qcy53ZWJSUHJvbWlzZSwgYmxvY2suY29kZSwgb3B0aW9ucyk7XG5cbiAgcmV0dXJuIGVkaXRvci5jb250YWluZXI7XG59XG5fd2Vicl92YWx1ZV8zID0gd2ViUk9qcy5wcm9jZXNzKF93ZWJyX2VkaXRvcl8zLCB7fSk7XG4ifSx7ImNlbGxOYW1lIjoid2Vici13aWRnZXQtMiIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6IntcbiAgLy8gV2FpdCBmb3Igb3V0cHV0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSwgdGhlbiB0cmlnZ2VyIHdpZGdldCByZW5kZXJpbmdcbiAgYXdhaXQgX3dlYnJfdmFsdWVfMjtcbiAgaWYgKHdpbmRvdy5IVE1MV2lkZ2V0cykge1xuICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTtcbiAgfVxuICBpZiAod2luZG93LlBhZ2VkVGFibGVEb2MpIHtcbiAgICB3aW5kb3cuUGFnZWRUYWJsZURvYy5pbml0QWxsKCk7XG4gIH1cbn1cbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLTIiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF93ZWJyX2VkaXRvcl8yID0ge1xuICBjb25zdCB7IFdlYlJFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuICBjb25zdCBzY3JpcHRDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcIndlYnItMi1jb250ZW50c1xcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGJsb2NrID0gSlNPTi5wYXJzZShiNjREZWNvZGUoc2NyaXB0Q29udGVudCkpO1xuXG4gIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgaWQ6IGB3ZWJyLTItY29udGVudHNgIH0sIGJsb2NrLmF0dHIpO1xuICBjb25zdCBlZGl0b3IgPSBuZXcgV2ViUkV4ZXJjaXNlRWRpdG9yKHdlYlJPanMud2ViUlByb21pc2UsIGJsb2NrLmNvZGUsIG9wdGlvbnMpO1xuXG4gIHJldHVybiBlZGl0b3IuY29udGFpbmVyO1xufVxuX3dlYnJfdmFsdWVfMiA9IHdlYlJPanMucHJvY2Vzcyhfd2Vicl9lZGl0b3JfMiwge30pO1xuIn0seyJjZWxsTmFtZSI6IndlYnItd2lkZ2V0LTEiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJ7XG4gIC8vIFdhaXQgZm9yIG91dHB1dCB0byBiZSB3cml0dGVuIHRvIHRoZSBET00sIHRoZW4gdHJpZ2dlciB3aWRnZXQgcmVuZGVyaW5nXG4gIGF3YWl0IF93ZWJyX3ZhbHVlXzE7XG4gIGlmICh3aW5kb3cuSFRNTFdpZGdldHMpIHtcbiAgICB3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKCk7XG4gIH1cbiAgaWYgKHdpbmRvdy5QYWdlZFRhYmxlRG9jKSB7XG4gICAgd2luZG93LlBhZ2VkVGFibGVEb2MuaW5pdEFsbCgpO1xuICB9XG59XG4ifSx7ImNlbGxOYW1lIjoid2Vici0xIiwiaW5saW5lIjpmYWxzZSwibWV0aG9kTmFtZSI6ImludGVycHJldCIsInNvdXJjZSI6InZpZXdvZiBfd2Vicl9lZGl0b3JfMSA9IHtcbiAgY29uc3QgeyBXZWJSRXhlcmNpc2VFZGl0b3IsIGI2NERlY29kZSB9ID0gd2luZG93Ll9leGVyY2lzZV9vanNfcnVudGltZTtcbiAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ3ZWJyLTEtY29udGVudHNcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBibG9jayA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKHNjcmlwdENvbnRlbnQpKTtcblxuICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IGlkOiBgd2Vici0xLWNvbnRlbnRzYCB9LCBibG9jay5hdHRyKTtcbiAgY29uc3QgZWRpdG9yID0gbmV3IFdlYlJFeGVyY2lzZUVkaXRvcih3ZWJST2pzLndlYlJQcm9taXNlLCBibG9jay5jb2RlLCBvcHRpb25zKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl93ZWJyX3ZhbHVlXzEgPSB3ZWJST2pzLnByb2Nlc3MoX3dlYnJfZWRpdG9yXzEsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJ3ZWJyLXByZWx1ZGUiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJ3ZWJST2pzID0ge1xuICBjb25zdCB7IFdlYlIsIENoYW5uZWxUeXBlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lLldlYlI7XG4gIGNvbnN0IHtcbiAgICBXZWJSRXZhbHVhdG9yLFxuICAgIFdlYlJFbnZpcm9ubWVudE1hbmFnZXIsXG4gICAgc2V0dXBSLFxuICAgIGI2NERlY29kZSxcbiAgICBjb2xsYXBzZVBhdGhcbiAgfSA9IHdpbmRvdy5fZXhlcmNpc2Vfb2pzX3J1bnRpbWU7XG5cbiAgY29uc3Qgc3RhdHVzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJleGVyY2lzZS1sb2FkaW5nLXN0YXR1c1wiKTtcbiAgY29uc3QgaW5kaWNhdG9yQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJleGVyY2lzZS1sb2FkaW5nLWluZGljYXRvclwiKTtcbiAgaW5kaWNhdG9yQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJkLW5vbmVcIik7XG5cbiAgbGV0IHN0YXR1c1RleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gIHN0YXR1c1RleHQuY2xhc3NMaXN0ID0gXCJleGVyY2lzZS1sb2FkaW5nLWRldGFpbHNcIjtcbiAgc3RhdHVzVGV4dCA9IHN0YXR1c0NvbnRhaW5lci5hcHBlbmRDaGlsZChzdGF0dXNUZXh0KTtcbiAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBJbml0aWFsaXNlYDtcblxuICAvLyBIb2lzdCBpbmRpY2F0b3Igb3V0IGZyb20gZmluYWwgc2xpZGUgd2hlbiBydW5uaW5nIHVuZGVyIHJldmVhbFxuICBjb25zdCByZXZlYWxTdGF0dXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJldmVhbCAuZXhlcmNpc2UtbG9hZGluZy1pbmRpY2F0b3JcIik7XG4gIGlmIChyZXZlYWxTdGF0dXMpIHtcbiAgICByZXZlYWxTdGF0dXMucmVtb3ZlKCk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXZlYWwgPiAuc2xpZGVzXCIpLmFwcGVuZENoaWxkKHJldmVhbFN0YXR1cyk7XG4gIH1cblxuICAvLyBNYWtlIGFueSByZXZlYWwgc2xpZGVzIHdpdGggbGl2ZSBjZWxscyBzY3JvbGxhYmxlXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmV2ZWFsIC5leGVyY2lzZS1jZWxsXCIpLmZvckVhY2goKGVsKSA9PiB7XG4gICAgZWwuY2xvc2VzdCgnc2VjdGlvbi5zbGlkZScpLmNsYXNzTGlzdC5hZGQoXCJzY3JvbGxhYmxlXCIpO1xuICB9KVxuXG4gIC8vIHdlYlIgc3VwcGxlbWVudGFsIGRhdGEgYW5kIG9wdGlvbnNcbiAgY29uc3QgZGF0YUNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwid2Vici1kYXRhXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKGRhdGFDb250ZW50KSk7XG5cbiAgLy8gR3JhYiBsaXN0IG9mIHJlc291cmNlcyB0byBiZSBkb3dubG9hZGVkXG4gIGNvbnN0IGZpbGVzQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHNjcmlwdFt0eXBlPVxcXCJ2ZnMtZmlsZVxcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGZpbGVzID0gSlNPTi5wYXJzZShiNjREZWNvZGUoZmlsZXNDb250ZW50KSk7XG5cbiAgLy8gVXNlIFBvc3RNZXNzYWdlIGNoYW5uZWwgZm9yIGFzeW5jIGNvbW11bmljYXRpb25cbiAgLy8gV2UgZG8gbm90IGV4cGVjdCB0byB0YWtlIG5lc3RlZCBwcm9tcHQgaW5wdXQgaW4gUXVhcnRvIExpdmUgY2VsbHNcbiAgZGF0YS5vcHRpb25zLmNoYW5uZWxUeXBlID0gQ2hhbm5lbFR5cGUuUG9zdE1lc3NhZ2U7XG5cbiAgLy8gSW5pdGlhbGlzZSB3ZWJSIGFuZCBzZXR1cCBmb3IgUiBjb2RlIGV2YWx1YXRpb25cbiAgbGV0IHdlYlJQcm9taXNlID0gKGFzeW5jICh3ZWJSKSA9PiB7XG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyB3ZWJSYDtcbiAgICBhd2FpdCB3ZWJSLmluaXQoKTtcblxuICAgIC8vIEluc3RhbGwgcHJvdmlkZWQgbGlzdCBvZiBwYWNrYWdlc1xuICAgIC8vIEVuc3VyZSB3ZWJSIGRlZmF1bHQgcmVwbyBpcyBpbmNsdWRlZFxuICAgIGRhdGEucGFja2FnZXMucmVwb3MucHVzaChcImh0dHBzOi8vcmVwby5yLXdhc20ub3JnXCIpXG4gICAgYXdhaXQgZGF0YS5wYWNrYWdlcy5wa2dzLm1hcCgocGtnKSA9PiAoKSA9PiB7XG4gICAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHBhY2thZ2U6ICR7cGtnfWA7XG4gICAgICByZXR1cm4gd2ViUi5ldmFsUlZvaWQoYFxuICAgICAgICB3ZWJyOjppbnN0YWxsKHBrZywgcmVwb3MgPSByZXBvcylcbiAgICAgICAgbGlicmFyeShwa2csIGNoYXJhY3Rlci5vbmx5ID0gVFJVRSlcbiAgICAgIGAsIHsgZW52OiB7XG4gICAgICAgIHBrZzogcGtnLFxuICAgICAgICByZXBvczogZGF0YS5wYWNrYWdlcy5yZXBvcyxcbiAgICAgIH19KTtcbiAgICB9KS5yZWR1Y2UoKGN1ciwgbmV4dCkgPT4gY3VyLnRoZW4obmV4dCksIFByb21pc2UucmVzb2x2ZSgpKTtcblxuICAgIC8vIERvd25sb2FkIGFuZCBpbnN0YWxsIHJlc291cmNlc1xuICAgIGF3YWl0IGZpbGVzLm1hcCgoZmlsZSkgPT4gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbmFtZSA9IGZpbGUuc3Vic3RyaW5nKGZpbGUubGFzdEluZGV4T2YoJy8nKSArIDEpO1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyByZXNvdXJjZTogJHtuYW1lfWA7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpbGUpO1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbid0IGRvd25sb2FkIFxcYCR7ZmlsZX1cXGAuIEVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfTogXCIke3Jlc3BvbnNlLnN0YXR1c1RleHR9XCIuYCk7XG4gICAgICB9XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcblxuICAgICAgLy8gU3RvcmUgVVJMcyBpbiB0aGUgY3dkIHdpdGhvdXQgYW55IHN1YmRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGlmIChmaWxlLmluY2x1ZGVzKFwiOi8vXCIpKSB7XG4gICAgICAgIGZpbGUgPSBuYW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBDb2xsYXBzZSBoaWdoZXIgZGlyZWN0b3J5IHN0cnVjdHVyZVxuICAgICAgZmlsZSA9IGNvbGxhcHNlUGF0aChmaWxlKTtcblxuICAgICAgLy8gQ3JlYXRlIGRpcmVjdG9yeSB0cmVlLCBpZ25vcmluZyBcImRpcmVjdG9yeSBleGlzdHNcIiBWRlMgZXJyb3JzXG4gICAgICBjb25zdCBwYXJ0cyA9IGZpbGUuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSk7XG4gICAgICBsZXQgcGF0aCA9ICcnO1xuICAgICAgd2hpbGUgKHBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcGF0aCArPSBwYXJ0cy5zaGlmdCgpICsgJy8nO1xuICAgICAgICBjb25zdCBhbmFseXNpcyA9IGF3YWl0IHdlYlIuRlMuYW5hbHl6ZVBhdGgocGF0aCk7XG4gICAgICAgIGlmICghYW5hbHlzaXMuZXhpc3RzKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHdlYlIuRlMubWtkaXIocGF0aCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlc3lzdGVtIEVycm9yOiBcIiR7ZS5tZXNzYWdlfVwiLmApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXcml0ZSB0aGlzIGZpbGUgdG8gdGhlIFZGU1xuICAgICAgcmV0dXJuIGF3YWl0IHdlYlIuRlMud3JpdGVGaWxlKGZpbGUsIG5ldyBVaW50OEFycmF5KGRhdGEpKTtcbiAgICB9KS5yZWR1Y2UoKGN1ciwgbmV4dCkgPT4gY3VyLnRoZW4obmV4dCksIFByb21pc2UucmVzb2x2ZSgpKTtcblxuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgSW5zdGFsbGluZyB3ZWJSIHNoaW1zYDtcbiAgICBhd2FpdCB3ZWJSLmV2YWxSVm9pZChgd2Vicjo6c2hpbV9pbnN0YWxsKClgKTtcblxuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgV2ViUiBlbnZpcm9ubWVudCBzZXR1cGA7XG4gICAgYXdhaXQgc2V0dXBSKHdlYlIsIGRhdGEpO1xuXG4gICAgc3RhdHVzVGV4dC5yZW1vdmUoKTtcbiAgICBpZiAoc3RhdHVzQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCA9PSAwKSB7XG4gICAgICBzdGF0dXNDb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHdlYlI7XG4gIH0pKG5ldyBXZWJSKGRhdGEub3B0aW9ucykpO1xuXG4gIC8vIEtlZXAgdHJhY2sgb2YgaW5pdGlhbCBPSlMgYmxvY2sgcmVuZGVyXG4gIGNvbnN0IHJlbmRlcmVkT2pzID0ge307XG5cbiAgY29uc3QgcHJvY2VzcyA9IGFzeW5jIChjb250ZXh0LCBpbnB1dHMpID0+IHtcbiAgICBjb25zdCB3ZWJSID0gYXdhaXQgd2ViUlByb21pc2U7XG4gICAgY29uc3QgZXZhbHVhdG9yID0gbmV3IFdlYlJFdmFsdWF0b3Iod2ViUiwgY29udGV4dClcbiAgICBhd2FpdCBldmFsdWF0b3IucHJvY2VzcyhpbnB1dHMpO1xuICAgIHJldHVybiBldmFsdWF0b3IuY29udGFpbmVyO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBwcm9jZXNzLFxuICAgIHdlYlJQcm9taXNlLFxuICAgIHJlbmRlcmVkT2pzLFxuICB9O1xufVxuIn1dfQ==
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
WyJkYXRhLyoqIiwiaW1hZ2VzLyoqIiwic3R5bGVzLmNzcyJd
</script>
</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/klh281\.github\.io\/UseR2025\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>